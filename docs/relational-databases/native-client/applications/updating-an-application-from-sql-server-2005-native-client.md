---
title: Native Client, mise à jour app SQL 2005
ms.custom: ''
ms.date: 03/14/2017
ms.prod: sql
ms.reviewer: ''
ms.technology: native-client
ms.topic: reference
helpviewer_keywords:
- SQL Server Native Client, updating applications
ms.assetid: 1e1e570c-7f14-4e16-beab-c328e3fbdaa8
author: markingmyname
ms.author: maghan
monikerRange: '>=aps-pdw-2016||=azuresqldb-current||=azure-sqldw-latest||>=sql-server-2016||=sqlallproducts-allversions||>=sql-server-linux-2017||=azuresqldb-mi-current'
ms.openlocfilehash: c047d243804b13733a7380ced362546ceda1e294
ms.sourcegitcommit: ce94c2ad7a50945481172782c270b5b0206e61de
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 04/14/2020
ms.locfileid: "81302498"
---
# <a name="updating-an-application-from-sql-server-2005-native-client"></a>Mise à jour d'une application depuis SQL Server 2005 Native Client
[!INCLUDE[appliesto-ss-asdb-asdw-pdw-md](../../../includes/appliesto-ss-asdb-asdw-pdw-md.md)]

  Cette rubrique décrit les modifications essentielles apportées à [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client depuis [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client dans [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)].  
  
 Lorsque vous effectuez une mise à niveau de MDAC (Microsoft Data Access Components) vers [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client, vous pouvez constater également des différences de comportement. Pour plus d’informations, voir [Mise à jour d’une application à SQL Server Native Client de MDAC](../../../relational-databases/native-client/applications/updating-an-application-to-sql-server-native-client-from-mdac.md).  
  
 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client 9.0 livré avec [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)]. [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client 10.0 livré avec [!INCLUDE[ssKatmai](../../../includes/sskatmai-md.md)].  [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client 10.5 livré avec [!INCLUDE[ssKilimanjaro](../../../includes/sskilimanjaro-md.md)]. [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client 11.0 livré avec [!INCLUDE[ssSQL11](../../../includes/sssql11-md.md)] et [!INCLUDE[ssSQL14](../../../includes/sssql14-md.md)].  
  
|Modification du comportement dans SQL Server Native Client depuis [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)]|Description|  
|------------------------------------------------------------------------------------|-----------------|  
|OLE DB effectue un remplissage uniquement à l'échelle définie.|Pour les conversions où les données [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] converties sont [!INCLUDE[ssKatmai](../../../includes/sskatmai-md.md)]envoyées au serveur, Native Client (à partir de) pads de suivi des zéros dans les données seulement jusqu’à la durée maximale des valeurs de **date.** SQL Server Native Client 9.0 effectuaient un remplissage à neuf chiffres.|  
|Validez DBTYPE_DBTIMESTAMP pour ICommandWithParameter::SetParameterInfo.|[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)]Native Client (à partir [!INCLUDE[ssKatmai](../../../includes/sskatmai-md.md)]de ) implémente l’exigence OLE DB pour *bScale* dans ICommandWithParameter::SetParameterInfo à définir à la précision fractionnelle secondes pour DBTYPE_DBTIMESTAMP.|  
|La procédure stockée **sp_columns** retourne maintenant **"NO"** au lieu de **"NO "** pour la colonne IS_NULLABLE.|Commençant [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] dans Native Client[!INCLUDE[ssKatmai](../../../includes/sskatmai-md.md)]10.0 ( ), **sp_columns** procédure stockée renvoie maintenant " NON **"** au lieu de « NON **»** pour une colonne IS_NULLABLE.|  
|SQLSetDescRec, SQLBindParameter et SQLBindCol effectuent maintenant une vérification de cohérence.|Avant [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Le client autochtone 10.0, le réglage SQL_DESC_DATA_PTR n’a pas causé de vérification de cohérence pour tout type de descripteur dans SQLSetDescRec, SQLBindParameter, ou SQLBindCol.|  
|SQLCopyDesc fait maintenant vérification de la cohérence descripteur.|Avant [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Le client autochtone 10.0, SQLCopyDesc n’a pas effectué de vérification de cohérence lorsque le champ SQL_DESC_DATA_PTR a été établi sur un record particulier.|  
|SQLGetDescRec ne vérifie plus la cohérence des descripteurs.|Avant [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client 10.0, SQLGetDescRec a effectué une vérification de la cohérence du descripteur lorsque le champ SQL_DESC_DATA_PTR a été réglé. Cela n'était pas requis par la spécification ODBC et dans [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client 10.0 ([!INCLUDE[ssKatmai](../../../includes/sskatmai-md.md)]) et les versions ultérieures, cette vérification de cohérence n'est plus effectuée.|  
|Erreur différente retournée lorsque la date est hors limites.|Pour le type **d’heure de date,** un numéro d’erreur différent sera retourné par [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client (à [!INCLUDE[ssKatmai](../../../includes/sskatmai-md.md)]partir de ) pour une date hors de portée que celle qui a été retournée dans les versions antérieures.<br /><br /> Plus [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] précisément, Native Client 9.0 retourné 22007 pour toutes les valeurs [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] de l’année hors de portée[!INCLUDE[ssKatmai](../../../includes/sskatmai-md.md)]dans les conversions de chaînes à **ce jour**, et Native Client à partir de la version 10.0 ( ) retourne 22008 lorsque la date est dans la plage soutenue par **datetime2,** mais en dehors de la plage soutenue par **datetime** ou **smalldatetime**.|  
|La valeur **datetime** tronque les fractions de seconde et n’arrondit pas si cela entraîne une modification du jour.|Avant [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client 10.0, le comportement client pour les valeurs **datetime** envoyées au serveur consistait à les arrondir au 1/300e de seconde. Depuis [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client 10.0, ce scénario provoque une troncation des fractions de seconde si l'arrondi modifie le jour.|  
|Troncation possible des secondes pour la valeur **datetime**.|Une application générée avec [!INCLUDE[ssKatmai](../../../includes/sskatmai-md.md)] Native Client (ou ultérieure) qui se connecte à un serveur [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 2005 tronquera des secondes et des fractions de seconde pour la partie heure des données envoyées au serveur si vous créez une liaison avec une colonne datetime avec un identificateur de type de DBTYPE_DBTIMESTAMP (OLE DB) ou SQL_TIMESTAMP (ODBC) et une échelle de 0.<br /><br /> Par exemple :<br /><br /> Données d'entrée : 1994-08-21 21:21:36.000<br /><br /> Données insérées : 1994-08-21 21:21:00.000|  
|La conversion de données OLE DB de DBTYPE_DBTIME vers DBTYPE_DATE ne peut plus provoquer de changement de jour.|Avant [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client 10.0, si la partie heure d'un DBTYPE_DATE était à moins d'une demi-seconde de minuit, le code de conversion OLE DB provoquait le changement de jour. Depuis [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client 10.0, le jour ne change pas (les fractions de seconde sont tronquées et non arrondies).|  
|Modifications de conversion IBCPSession::BCColFmt.|Commençant [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] dans Native Client 10.0, lorsque vous utilisez IBCPSession::BCOColFmt pour convertir SQLDATETIME ou SQLDATETIME en un type de chaîne, une valeur fractionnée est exportée. Par exemple, lors de la conversion du type SQLDATETIME vers le type SQLNVARCHARMAX, les versions antérieures de [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client retournaient<br /><br /> 1989-02-01 00:00:00. [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client 10.0 et versions ultérieures retournent 1989-02-01 00:00:00.0000000.|  
|La taille des données envoyées doit correspondre à la longueur spécifiée dans SQL_LEN_DATA_AT_EXEC.|Lors de l'utilisation de SQL_LEN_DATA_AT_EXEC, la taille des données doit correspondre à la longueur que vous avez spécifiée avec SQL_LEN_DATA_AT_EXEC. Vous pouvez utiliser SQL_DATA_AT_EXEC, mais l'utilisation de SQL_LEN_DATA_AT_EXEC présente certains avantages en matière de performances.|  
|Les applications personnalisées qui utilisent l'API BCP peuvent maintenant afficher un avertissement.|L'API BCP génère un message d'avertissement si la longueur des données est supérieure à la longueur spécifiée pour un champ pour tous les types. Auparavant, cet avertissement était affiché uniquement pour les types caractère, et non pour tous les types.|  
|L’insertion d’une chaîne vide dans un **sql_variant** lié en tant que type date/heure génère une erreur.|Dans [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client 9.0, l’insertion d’une chaîne vide dans un **sql_variant** lié en tant que type date/heure ne générait pas d’erreur. [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client 10.0 (et versions ultérieures) génère correctement une erreur dans cette situation.|  
|Validation des paramètres _TIMESTAMP SQL_C_TYPE et DBTYPE_DBTIMESTAMP plus stricte.|Avant [!INCLUDE[ssKatmai](../../../includes/sskatmai-md.md)] le client autochtone, les valeurs **d’heure de date** étaient arrondies pour s’adapter à l’échelle de **date et** aux colonnes **de smalldatetime** par [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)]. [!INCLUDE[ssKatmai](../../../includes/sskatmai-md.md)] Native Client (et versions ultérieures) applique maintenant les règles de validation plus strictes définies dans la spécification principale ODBC pour les fractions de seconde. Si une valeur de paramètre ne peut pas être convertie au type SQL à l'aide de l'échelle spécifiée ou déduite de la liaison de client sans troncation des chiffres de fin, une erreur est retournée.|  
|[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] peut retourner des résultats différents lorsque le déclencheur s’exécute.|Des modifications apportées dans [!INCLUDE[ssKatmai](../../../includes/sskatmai-md.md)] ont pu amener une application à avoir des résultats différents retournés par une instruction, ce qui a entraîné l’exécution d’un déclencheur quand **NOCOUNT OFF** était actif. Dans ce cas, votre application peut générer une erreur. Pour résoudre cette erreur, définissez **NOCOUNT sur** la gâchette ou appelez SQLMoreResults pour passer au résultat suivant.|  
  
## <a name="see-also"></a>Voir aussi  
 [Programmation de SQL Server Native Client](../../../relational-databases/native-client/sql-server-native-client-programming.md)  
  
  
